D:\softwares\anaconda3\envs\RGAT20230627\python.exe "D:\softwares\Pycharm\PyCharm Community Edition 2022.1.3\plugins\python-ce\helpers\pydev\pydevd.py" --multiprocess --qt-support=auto --client 127.0.0.1 --port 9092 --file F:/Code/240313/gat/graph/gcn_gat_link_weight_node/main_mydata.py
Connected to pydev debugger (build 221.5921.27)
Loading zh dataset...
D:\softwares\anaconda3\envs\RGAT20230627\lib\site-packages\torch_geometric\deprecation.py:26: UserWarning: 'train_test_split_edges' is deprecated, use 'transforms.RandomLinkSplit' instead
  warnings.warn(out)
Epoch: 001, Loss: 1.0001, Val: 0.5000, Test: 0.5000
Epoch: 002, Loss: 0.6448, Val: 0.4884, Test: 0.5000
Epoch: 003, Loss: 0.6574, Val: 0.4256, Test: 0.5000
Epoch: 004, Loss: 0.6615, Val: 0.5000, Test: 0.5000
Epoch: 005, Loss: 0.6684, Val: 0.5000, Test: 0.5000
Epoch: 006, Loss: 0.6681, Val: 0.5000, Test: 0.5000
Epoch: 007, Loss: 0.6663, Val: 0.5000, Test: 0.5000
Epoch: 008, Loss: 0.6647, Val: 0.5000, Test: 0.5000
Epoch: 009, Loss: 0.6504, Val: 0.5116, Test: 0.5058
Epoch: 010, Loss: 0.6425, Val: 0.5116, Test: 0.5058
Epoch: 011, Loss: 0.6526, Val: 0.6425, Test: 0.5971
Epoch: 012, Loss: 0.6408, Val: 0.5998, Test: 0.5971
Epoch: 013, Loss: 0.6187, Val: 0.5744, Test: 0.5971
Epoch: 014, Loss: 0.6162, Val: 0.5457, Test: 0.5971
Epoch: 015, Loss: 0.6480, Val: 0.5635, Test: 0.5971
Epoch: 016, Loss: 0.6172, Val: 0.6063, Test: 0.5971
Epoch: 017, Loss: 0.5951, Val: 0.5884, Test: 0.5971
Epoch: 018, Loss: 0.6101, Val: 0.5533, Test: 0.5971
Epoch: 019, Loss: 0.6075, Val: 0.5868, Test: 0.5971
Epoch: 020, Loss: 0.5829, Val: 0.5814, Test: 0.5971
Epoch: 021, Loss: 0.5879, Val: 0.5614, Test: 0.5971
Epoch: 022, Loss: 0.6037, Val: 0.5717, Test: 0.5971
Epoch: 023, Loss: 0.5762, Val: 0.5949, Test: 0.5971
Epoch: 024, Loss: 0.5703, Val: 0.6360, Test: 0.5971
Epoch: 025, Loss: 0.5928, Val: 0.5949, Test: 0.5971
Epoch: 026, Loss: 0.5763, Val: 0.5181, Test: 0.5971
Epoch: 027, Loss: 0.5807, Val: 0.5116, Test: 0.5971
Epoch: 028, Loss: 0.5893, Val: 0.5489, Test: 0.5971
Epoch: 029, Loss: 0.5723, Val: 0.5782, Test: 0.5971
Epoch: 030, Loss: 0.5738, Val: 0.6171, Test: 0.5971
Epoch: 031, Loss: 0.5730, Val: 0.6290, Test: 0.5971
Epoch: 032, Loss: 0.5930, Val: 0.6593, Test: 0.5062
Epoch: 033, Loss: 0.5984, Val: 0.7896, Test: 0.6961
Epoch: 034, Loss: 0.5676, Val: 0.5873, Test: 0.6961
Epoch: 035, Loss: 0.5795, Val: 0.5717, Test: 0.6961
Epoch: 036, Loss: 0.5745, Val: 0.5917, Test: 0.6961
Epoch: 037, Loss: 0.5936, Val: 0.7025, Test: 0.6961
Epoch: 038, Loss: 0.5624, Val: 0.7501, Test: 0.6961
Epoch: 039, Loss: 0.5750, Val: 0.7442, Test: 0.6961
Epoch: 040, Loss: 0.5724, Val: 0.7372, Test: 0.6961
Epoch: 041, Loss: 0.5723, Val: 0.7485, Test: 0.6961
Epoch: 042, Loss: 0.5625, Val: 0.7691, Test: 0.6961
Epoch: 043, Loss: 0.5764, Val: 0.7280, Test: 0.6961
Epoch: 044, Loss: 0.5715, Val: 0.7009, Test: 0.6961
Epoch: 045, Loss: 0.5499, Val: 0.6869, Test: 0.6961
Epoch: 046, Loss: 0.5512, Val: 0.6896, Test: 0.6961
Epoch: 047, Loss: 0.5716, Val: 0.7377, Test: 0.6961
Epoch: 048, Loss: 0.5639, Val: 0.8107, Test: 0.6532
Epoch: 049, Loss: 0.5443, Val: 0.7994, Test: 0.6532
Epoch: 050, Loss: 0.5509, Val: 0.7734, Test: 0.6532
Epoch: 051, Loss: 0.5577, Val: 0.7388, Test: 0.6532
Epoch: 052, Loss: 0.5530, Val: 0.7074, Test: 0.6532
Epoch: 053, Loss: 0.5575, Val: 0.7101, Test: 0.6532
Epoch: 054, Loss: 0.5611, Val: 0.7658, Test: 0.6532
Epoch: 055, Loss: 0.5388, Val: 0.8459, Test: 0.6970
Epoch: 056, Loss: 0.5713, Val: 0.7966, Test: 0.6970
Epoch: 057, Loss: 0.5471, Val: 0.7382, Test: 0.6970
Epoch: 058, Loss: 0.5588, Val: 0.7107, Test: 0.6970
Epoch: 059, Loss: 0.5605, Val: 0.7280, Test: 0.6970
Epoch: 060, Loss: 0.5587, Val: 0.7701, Test: 0.6970
Epoch: 061, Loss: 0.5625, Val: 0.7566, Test: 0.6970
Epoch: 062, Loss: 0.5541, Val: 0.7939, Test: 0.6970
Epoch: 063, Loss: 0.5488, Val: 0.7469, Test: 0.6970
Epoch: 064, Loss: 0.5509, Val: 0.7409, Test: 0.6970
Epoch: 065, Loss: 0.5468, Val: 0.7409, Test: 0.6970
Epoch: 066, Loss: 0.5379, Val: 0.7274, Test: 0.6970
Epoch: 067, Loss: 0.5384, Val: 0.6804, Test: 0.6970
Epoch: 068, Loss: 0.5532, Val: 0.7128, Test: 0.6970
Epoch: 069, Loss: 0.5355, Val: 0.7031, Test: 0.6970
Epoch: 070, Loss: 0.5241, Val: 0.6944, Test: 0.6970
Epoch: 071, Loss: 0.5510, Val: 0.7025, Test: 0.6970
Epoch: 072, Loss: 0.5511, Val: 0.7031, Test: 0.6970
Epoch: 073, Loss: 0.5293, Val: 0.6923, Test: 0.6970
Epoch: 074, Loss: 0.5739, Val: 0.7198, Test: 0.6970
Epoch: 075, Loss: 0.5497, Val: 0.7431, Test: 0.6970
Epoch: 076, Loss: 0.5452, Val: 0.7296, Test: 0.6970
Epoch: 077, Loss: 0.5537, Val: 0.7166, Test: 0.6970
Epoch: 078, Loss: 0.5570, Val: 0.7161, Test: 0.6970
Epoch: 079, Loss: 0.5431, Val: 0.7388, Test: 0.6970
Epoch: 080, Loss: 0.5363, Val: 0.7442, Test: 0.6970
Epoch: 081, Loss: 0.5436, Val: 0.7539, Test: 0.6970
Epoch: 082, Loss: 0.5478, Val: 0.7550, Test: 0.6970
Epoch: 083, Loss: 0.5570, Val: 0.7729, Test: 0.6970
Epoch: 084, Loss: 0.5391, Val: 0.7680, Test: 0.6970
Epoch: 085, Loss: 0.5464, Val: 0.7696, Test: 0.6970
Epoch: 086, Loss: 0.5444, Val: 0.7631, Test: 0.6970
Epoch: 087, Loss: 0.5513, Val: 0.7810, Test: 0.6970
Epoch: 088, Loss: 0.5480, Val: 0.7912, Test: 0.6970
Epoch: 089, Loss: 0.5440, Val: 0.7907, Test: 0.6970
Epoch: 090, Loss: 0.5491, Val: 0.7966, Test: 0.6970
Epoch: 091, Loss: 0.5392, Val: 0.8085, Test: 0.6970
Epoch: 092, Loss: 0.5398, Val: 0.7885, Test: 0.6970
Epoch: 093, Loss: 0.5414, Val: 0.7983, Test: 0.6970
Epoch: 094, Loss: 0.5423, Val: 0.8248, Test: 0.6970
Epoch: 095, Loss: 0.5484, Val: 0.8388, Test: 0.6970
Epoch: 096, Loss: 0.5573, Val: 0.8204, Test: 0.6970
Epoch: 097, Loss: 0.5275, Val: 0.8042, Test: 0.6970
Epoch: 098, Loss: 0.5371, Val: 0.8161, Test: 0.6970
Epoch: 099, Loss: 0.5278, Val: 0.8405, Test: 0.6970
Epoch: 100, Loss: 0.5316, Val: 0.8378, Test: 0.6970



def get_link_weight(link_label):
    type = re.findall(r'\[(.*?)\]', link_label)[0]
    if type == 'but':
        return 0.3
    elif type == 'causal':
        return 2.0
    elif type == 'condition':
        return 1.5
    elif type == 'more':
        return 1.0
    elif type == 'seq':
        return 2.0